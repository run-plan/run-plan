{% extends 'layouts.layout' %}

{% block header_right %}
    <div class="col width-fill mobile-width-fill">
        <div class="cell">
            <ul class="col nav">
                <li class="active"><a id="start" href="javascript:void(0);">スタート</a></li>
            </ul>
        </div>
    </div>
{% endblock %}

{% block javascript %}
    <script type="text/javascript">
        $(document).ready(function () {
            var timer_id = null;
            $('#start').click(function () {
                timer_id = setInterval(plot, 8000);
            });

            $('#end').click(function () {
                clearInterval(timer_id);
            });

            function plot() {
                navigator.geolocation.getCurrentPosition(
                        // （1）位置情報の取得に成功した場合
                        function (pos) {
                            var date = new Date();
                            var location = "時刻：" + date.getHours() + '時'
                                    + date.getMinutes() + '分'
                                    + date.getSeconds() + '秒';
                            location += "<緯度：" + pos.coords.latitude + '>';
                            location += "<経度：" + pos.coords.longitude + '>';
                            document.getElementById("location").innerHTML = location;

                            var latlng = new google.maps.LatLng(pos.coords.latitude, pos.coords.longitude);
                            var marker = new google.maps.Marker({
                                position: latlng,
                                map: map
                            });
                        },
                        // （2）位置情報の取得に失敗した場合
                        function (error) {
                            var message = "";

                            switch (error.code) {

                                // 位置情報が取得できない場合
                                case error.POSITION_UNAVAILABLE:
                                    message = "位置情報の取得ができませんでした。";
                                    break;

                                // Geolocationの使用が許可されない場合
                                case error.PERMISSION_DENIED:
                                    message = "位置情報取得の使用許可がされませんでした。";
                                    break;

                                // タイムアウトした場合
                                case error.PERMISSION_DENIED_TIMEOUT:
                                    message = "位置情報取得中にタイムアウトしました。";
                                    break;
                            }
                            window.alert(message);
                        }
                );
            }
        });
    </script>
{% endblock %}

{% block contents %}
    <div class="cell">
        <div id="location"></div>
        <div id="map_canvas" style="width:100%; height:250px;"><span class="icon spin icon-64 icon-spinner"></span>
        </div>

    </div>
{% endblock %}